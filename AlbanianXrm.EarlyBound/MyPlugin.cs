using System;
using System.ComponentModel.Composition;
using System.IO;
using System.Linq;
using System.Collections.Generic;
using System.Reflection;
using XrmToolBox.Extensibility;
using XrmToolBox.Extensibility.Interfaces;

namespace AlbanianXrm.EarlyBound
{
    // Do not forget to update version number and author (company attribute) in AssemblyInfo.cs class
    // To generate Base64 string for Images below, you can use https://www.base64-image.de/
    [Export(typeof(IXrmToolBoxPlugin)),
        ExportMetadata("Name", "Albanian Early Bound"),
        ExportMetadata("Company", "Betim Beja"),
        ExportMetadata("Description", "This plugin generates early bound entities using svcutil.exe giving the possibility to choose the wanted attributes"),
        // Please specify the base64 content of a 32x32 pixels image
        ExportMetadata("SmallImageBase64", "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"),
        // Please specify the base64 content of a 80x80 pixels image
        ExportMetadata("BigImageBase64", "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"),
        ExportMetadata("BackgroundColor", "Lavender"),
        ExportMetadata("PrimaryFontColor", "Black"),
        ExportMetadata("SecondaryFontColor", "Gray")]
    public class MyPlugin : PluginBase
    {
        public override IXrmToolBoxPluginControl GetControl()
        {
            return new MyPluginControl();
        }

        /// <summary>
        /// Constructor 
        /// </summary>
        public MyPlugin()
        {
            Syncfusion.Licensing.SyncfusionLicenseProvider.RegisterLicense("Acquire License from Syncfusion");
            
            // If you have external assemblies that you need to load, uncomment the following to 
            // hook into the event that will fire when an Assembly fails to resolve
            // AppDomain.CurrentDomain.AssemblyResolve += new ResolveEventHandler(AssemblyResolveEventHandler);
        }

        /// <summary>
        /// Event fired by CLR when an assembly reference fails to load
        /// Assumes that related assemblies will be loaded from a subfolder named the same as the Plugin
        /// For example, a folder named Sample.XrmToolBox.MyPlugin 
        /// </summary>
        /// <param name="sender"></param>
        /// <param name="args"></param>
        /// <returns></returns>
        private Assembly AssemblyResolveEventHandler(object sender, ResolveEventArgs args)
        {
            Assembly loadAssembly = null;
            Assembly currAssembly = Assembly.GetExecutingAssembly();

            // base name of the assembly that failed to resolve
            var argName = args.Name.Substring(0, args.Name.IndexOf(","));

            // check to see if the failing assembly is one that we reference.
            List<AssemblyName> refAssemblies = currAssembly.GetReferencedAssemblies().ToList();
            var refAssembly = refAssemblies.Where(a => a.Name == argName).FirstOrDefault();

            // if the current unresolved assembly is referenced by our plugin, attempt to load
            if (refAssembly != null)
            {
                // load from the path to this plugin assembly, not host executable
                string dir = Path.GetDirectoryName(currAssembly.Location).ToLower();
                string folder = Path.GetFileNameWithoutExtension(currAssembly.Location);
                dir = Path.Combine(dir, folder);

                var assmbPath = Path.Combine(dir, $"{argName}.dll");

                if (File.Exists(assmbPath))
                {
                    loadAssembly = Assembly.LoadFrom(assmbPath);
                }
                else
                {
                    throw new FileNotFoundException($"Unable to locate dependency: {assmbPath}");
                }
            }

            return loadAssembly;
        }
    }
}